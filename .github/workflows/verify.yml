name: V4 Swift SDK - Quick Verify

# Fast verification on every push - runs all tests in parallel
# For comprehensive testing (multi-platform, coverage, etc.), see v4-tests.yml

on:
  push:
  pull_request:
    branches:
      - master
      - main

jobs:
  quick-verify:
    name: Build & Test (All Suites)
    runs-on: macos-15
    timeout-minutes: 20
    steps:
      - name: Check out code
        uses: actions/checkout@v4

      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: '16.0'

      - name: Cache Swift packages
        uses: actions/cache@v4
        with:
          path: .build
          key: ${{ runner.os }}-spm-${{ hashFiles('Package.resolved') }}
          restore-keys: |
            ${{ runner.os }}-spm-

      - name: Build SDK
        run: swift build

      - name: Run all tests (Unit + Integration + Performance)
        run: swift test --parallel
